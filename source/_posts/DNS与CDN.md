---
title: DNS与CDN
date: 2019-12-30 20:41:19
tags: Http
---
### DNS
DNS（Domain Name System，<span style="color:#2196F3">域名系统</span> ），万维网上作为域名和IP地址相互映射的一个<span style="color:#2196F3">分布式数据库</span>，能够使用户更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。通过域名，最终得到该域名对应的IP地址的过程叫做域名解析（或主机名解析）。DNS协议运行在<span style="color:#2196F3">UDP</span>协议之上，使用端口号53。

[DNS缓存](https://blog.csdn.net/yonggeit/article/details/88175022)

### CDN
注意：http缓存是浏览器端缓存，cdn是服务器端缓存。

http缓存是浏览器端缓存，cdn是服务器端缓存。
CDN的全称是Content Delivery Network，即内容分发网络。CDN是构建在网络之上内容分发网络，依靠在各地部署的缓存服务器，通过中心平台的负载均衡/内容分发/调度等功能模块，使用户可以就近获取所需要的内容，从而达到降低网络用塞，提高系统访问速度的技术。CDN的关键技术是内容存储和分发技术。

CDN的思路是：通过在网络各处放节点服务器，这个服务器构成在现有网络基础之上的一层智能虚拟网络，CDN能够将用户的请求分发到距离用户最近的服务器节点上，提高用户访问速度。比如：100台CDN服务器分布在全国各地，如果从广东访问，会从最近的节点返回资源，这就是核心。

#### 完整的CDN工作流程：

<img style="margin:0 auto;" src="/images/CDN.png" />

#### 访问流程详解：
（1）当用户点击网站页面上的内容URL，经过本地DNS系统解析，DNS系统会最终将域名的解析权交给CNAME指向的CDN专用DNS服务器。

（2）CDN的DNS服务器将CDN的全局负载均衡设备IP地址返回用户。

（3）用户向CDN的全局负载均衡设备发起内容URL访问请求。

（4）CDN全局负载均衡设备根据用户IP地址，以及用户请求的内容URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求。

（5）区域负载均衡设备会为用户选择一台合适的缓存服务器提供服务，选择的依据包括：根据用户IP地址，判断哪一台服务器距用户最近；根据用户所请求的URL中携带的内容名称，判断哪一台服务器上有用户所需内容；查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。基于以上这些条件的综合分析之后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的IP地址。

（6）全局负载均衡设备把服务器的IP地址返回给用户。

（7）用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域均衡设备依然将它分配给了用户，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地。
![CDN](/images/CDN2.png)